<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Community</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">
    <style>
        body {
            font-family: 'Poppins', sans-serif;
            background-color: #111;
            color: #fff;
            padding: 20px;
        }

        .community-header {
            margin-bottom: 20px;
            text-align: center;
        }

        .grid-container {
            display: grid;
            grid-template-columns: repeat(2, 1fr); /* Two columns per row */
            gap: 20px;
        }

        .grid-item {
            background-color: #222;
            padding: 15px;
            border-radius: 10px;
            display: flex;
            flex-direction: column;
            align-items: center;
            opacity: 0; /* Initially hidden */
            transform: translateY(20px); /* Start from below */
            transition: opacity 0.5s ease-out, transform 0.5s ease-out; /* Transition effect */
        }

        .grid-item.visible {
            opacity: 1; /* Make visible when scrolled into view */
            transform: translateY(0); /* Move to original position */
        }

        .btn {
            background-color: #7c3aed;
            color: #fff;
        }
        
        .event-card {
            background-color: #2a2a2a;
            padding: 15px;
            border-radius: 10px;
            margin-top: 15px;
            display: flex;
            justify-content: space-between;
        }

        .event-card img {
            border-radius: 10px;
            width: 100px;
            height: 140px;
        }

        .event-details {
            margin-left: 10px;
            width: 800px;
        }

        .event-details h5 {
            font-weight: 600;
            font-size: 16px;
        }

        .event-details p {
            font-size: 14px;
            margin: 5px 0;
        }


        .chat-box {
            width: 100%;
            background-color: #333;
            border-radius: 10px;
            padding: 10px;
            max-height: 200px;
            overflow-y: auto;
            margin-top: 10px;
        }

        .chat-input {
            margin-top: 10px;
            display: flex;
        }

        .chat-input input {
            flex: 1;
            border-radius: 10px;
            margin-right: 10px;
            padding: 5px;
        }

        .placeholder-image {
            width: 100%;
            height: 200px;
            
            border-radius: 10px;
        }
        .feedback-section {
            background-color: #222;
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
            color: #fff;
        }

        .feedback-section h3 {
            margin-bottom: 15px;
        }

        .feedback-section input, .feedback-section textarea {
            margin-bottom: 10px;
        }

        .feedback-section img {
            width: 100%;
            max-height: 200px;
            object-fit: cover;
            border-radius: 10px;
            margin-top: 10px;
        }

        .chat-message {
            color: #fff;
            margin-bottom: 5px;
        }
    </style>
</head>
<body>
    <div class="community-header">
        <h1>Community</h1>
        <button class="btn mb-3" onclick="toggleCreateCommunity()">Create Community</button>
        <div id="create-community-form" style="display: none;">
            <input type="text" id="community-name" class="form-control mb-2" placeholder="Community Name">
            <select id="community-type" class="form-control mb-2">
                <option>Public</option>
                <option>Private</option>
            </select>
            <input type="number" id="age-restriction" class="form-control mb-2" placeholder="Age Restriction (Optional)">
            <button class="btn" onclick="createCommunity()">Submit</button>
        </div>
    </div>

    <div class="grid-container" style="display: flex; overflow: auto;">
        <!-- Example Communities -->
        <div class="grid-item" data-code="STUDENT2023">
            <h4>Student Community</h4>
            <p>Type: Public</p>
            <button class="btn" onclick="toggleJoinForm(this, 'Student Community', 'STUDENT2023')">Join</button>
            <div class="join-form mt-2" style="display: none;">
                <input type="text" class="form-control mb-2" placeholder="Enter Code">
                <button class="btn" onclick="joinCommunity(this, 'Student Community')">Submit</button>
            </div>
        </div>

        
        <div class="grid-item" data-code="XYZ2023">
            <h4>XYZ Apartment Community</h4>
            <p>Type: Private</p>
            <button class="btn" onclick="toggleJoinForm(this, 'XYZ Apartment Community', 'XYZ2023')">Join</button>
            <div class="join-form mt-2" style="display: none;">
                <input type="text" class="form-control mb-2" placeholder="Enter Code">
                <button class="btn" onclick="joinCommunity(this, 'XYZ Apartment Community')">Submit</button>
            </div>
        </div>
        
        <div class="grid-item" data-code="HYDWA2023">
            <h4>Hyderabad Women Association</h4>
            <p>Type: Public</p>
            <button class="btn" onclick="toggleJoinForm(this, 'Hyderabad Women Association', 'HYDWA2023')">Join</button>
            <div class="join-form mt-2" style="display: none;">
                <input type="text" class="form-control mb-2" placeholder="Enter Code">
                <button class="btn" onclick="joinCommunity(this, 'Hyderabad Women Association')">Submit</button>
            </div>
        </div>
        
        
        <div class="grid-item" data-code="HYDTC2023">
            <h4>Hyderabad Tech Community</h4>
            <p>Type: Private</p>
            <button class="btn" onclick="toggleJoinForm(this, 'Hyderabad Tech Community', 'HYDTC2023')">Join</button>
            <div class="join-form mt-2" style="display: none;">
                <input type="text" class="form-control mb-2" placeholder="Enter Code">
                <button class="btn" onclick="joinCommunity(this, 'Hyderabad Tech Community')">Submit</button>
            </div>
        </div>
      
        
        <div class="grid-item" data-code="XYZ2023">
            <h4>Pragathi Colony Community</h4>
            <p>Type: Private</p>
            <button class="btn" onclick="toggleJoinForm(this, 'XYZ Apartment Community', 'XYZ2023')">Join</button>
            <div class="join-form mt-2" style="display: none;">
                <input type="text" class="form-control mb-2" placeholder="Enter Code">
                <button class="btn" onclick="joinCommunity(this, 'XYZ Apartment Community')">Submit</button>
            </div>
        </div>
    </div>
    <div id="community-chat-box" style="display: none;">
        <div class="chat-box">
            <h5 id="chat-community-name">Community Chat</h5>
            <div id="chat-messages" class="chat-messages"></div>
            <div class="chat-input">
                <input id="chat-message" type="text" placeholder="Type a message">
                <button class="btn" onclick="sendMessage()">Send</button>
            </div>
        </div>
    </div>
    <h3 class="section-title mt-5">Upcoming Events</h3>

    <!-- Event Card 1 -->
    <div class="event-card">
        <a href="event1.html"><img src="https://news.globalindianschool.org/content/thumbnail/fire-drill-session4x.jpg" alt="Event Image"></a>
        <div class="event-details">
            <h5>Fire Safety Drill</h5>
            <p>Date: Nov 15, 2023<br>Time: 10:00 AM - 11:30 AM</p>
            <p>Join us for a comprehensive fire safety drill to ensure preparedness in case of emergencies.</p>
        </div>
    </div>

    
    <!-- Event Card 2 -->
    <div class="event-card">
        <a href="event2.html"><img src="https://th.bing.com/th/id/OIP.QwAa3ESXIkjZuCT4n0GK0QHaHa?rs=1&pid=ImgDetMain" alt="Event Image"></a>
        <div class="event-details">
            <h5>Cyber Safety Workshop</h5>
            <p>Date: Nov 22, 2023<br>Time: 2:00 PM - 4:00 PM</p>
            <p>Learn about the latest cyber threats and how to protect your digital identity.</p>
        </div>
    </div>

    <!-- Event Card 3 -->
    <div class="event-card">
        <a href="evemt3.html"><img src="https://th.bing.com/th/id/OIP.ogVF0-PFxAyE59UjYdO6gQHaEW?rs=1&pid=ImgDetMain" alt="Event Image"></a>
        <div class="event-details">
            <h5>First Aid Training</h5>
            <p>Date: Dec 5, 2023<br>Time: 9:00 AM - 12:00 PM</p>
            <p>Acquire essential first aid skills and knowledge to respond to emergencies effectively.</p>
        </div>
    </div>

    <div class="feedback-section">
        <h3>Share Your Feedback or Contributions</h3>
        <form id="feedback-form">
            <input type="text" id="feedback-title" class="form-control" placeholder="Title of Your Contribution or Feedback" required>
            <textarea id="feedback-description" class="form-control" rows="4" placeholder="Describe your experience or contribution..." required></textarea>
            <label for="feedback-image" class="form-label mt-2">Upload a Picture (optional):</label>
            <input type="file" id="feedback-image" class="form-control" accept="image/*">
            <button type="button" class="btn mt-3" onclick="submitFeedback()">Submit</button>
        </form>
        <div id="feedback-message" class="mt-3"></div>
    </div>

    <div id="chatbot-container" style="margin-top: 20px;">
        <script
            src="https://app.livechatai.com/embed.js"
            data-id="cm53zpeqa0007mj0bpfhmn1cu"
            async defer>
        </script>
    </div>


    <script>
        // Toggle Create Community Form
        function toggleCreateCommunity() {
            const form = document.getElementById('create-community-form');
            form.style.display = form.style.display === 'none' ? 'block' : 'none';
        }

        // Toggle Join Form
        function toggleJoinForm(button, community, code) {
            const joinForm = button.nextElementSibling;
            joinForm.style.display = joinForm.style.display === 'none' ? 'block' : 'none';
            joinForm.setAttribute('data-community-code', code);
        }

        // Create Community
        // Create Community
    function createCommunity() {
    const name = document.getElementById('community-name').value;
    const type = document.getElementById('community-type').value;
    const age = document.getElementById('age-restriction').value;
    const communityCode = generateCommunityCode(name);

    // Create community object
    const community = {
        name,
        type,
        code: communityCode
    };

    // Store the community in localStorage
    let communities = JSON.parse(localStorage.getItem('communities')) || [];
    communities.push(community);
    localStorage.setItem('communities', JSON.stringify(communities));

    // Append the new community to the grid container
    addCommunityToGrid(community);

    // Clear input fields
    document.getElementById('community-name').value = '';
    document.getElementById('community-type').value = 'Public'; 
    document.getElementById('age-restriction').value = '';
    
    alert(`Community "${name}" created successfully!`);
}

// Function to add community to the grid
function addCommunityToGrid(community) {
    const newCommunity = document.createElement('div');
    newCommunity.className = 'grid-item visible'; 
    newCommunity.setAttribute('data-code', community.code);
    newCommunity.innerHTML = `
        <h4>${community.name}</h4>
        <p>Type: ${community.type}</p>
        <button class="btn" onclick="toggleJoinForm(this, '${community.name}', '${community.code}')">Join</button>
        <div class="join-form mt-2" style="display: none;">
            <input type="text" class="form-control mb-2" placeholder="Enter Code">
            <button class="btn" onclick="joinCommunity(this, '${community.name}')">Submit</button>
        </div>
    `;

    // Append the new community to the grid container
    document.querySelector('.grid-container').appendChild(newCommunity);
}

// On page load, populate the grid with communities from localStorage
document.addEventListener('DOMContentLoaded', () => {
    const communities = JSON.parse(localStorage.getItem('communities')) || [];
    communities.forEach(addCommunityToGrid); // Add each community to the grid
});


// Function to generate a simple community code (you can adjust this logic as needed)
function generateCommunityCode(name) {
    return name.split(' ').join('').toUpperCase() + Date.now(); // Example code generation logic
}


        // Join Community
        function joinCommunity(button, community) {
            const joinForm = button.closest('.join-form');
            const codeInput = joinForm.querySelector('input[type="text"]');
            const enteredCode = codeInput.value;
            const communityCode = button.closest('.grid-item').getAttribute('data-code');

            if (enteredCode === communityCode) {
                alert(`Joined "${community}" successfully!`);
                const parent = button.closest('.grid-item');

                // Remove join button and replace it with leave button
                const joinButton = parent.querySelector('button');
                joinButton.outerHTML = `<button class="btn" onclick="leaveCommunity(this, '${community}')">Leave</button>`;

                // Show chat box
                const placeholder = parent.nextElementSibling.querySelector('.placeholder-image');
                placeholder.outerHTML = `
                    <div class="chat-box">
                        <h5>Chat - ${community}</h5>
                        <div class="chat-messages"></div>
                        <div class="chat-input">
                            <input type="text" placeholder="Type a message" onkeypress="sendMessage(event, this, '${community}')">
                            <button class="btn" onclick="sendMessage(event, this, '${community}')">Send</button>
                        </div>
                    </div>
                `;
            } else {
                alert('Please enter a valid code to join the community.');
            }
        }

        // Leave Community
        function leaveCommunity(button, community) {
            const parent = button.closest('.grid-item');
            const joinButton = button.outerHTML = `<button class="btn" onclick="toggleJoinForm(this, '${community}', '${parent.getAttribute('data-code')}')">Join</button>`;
            const chatBox = parent.nextElementSibling.querySelector('.chat-box');
            chatBox.outerHTML = `<div class="placeholder-image"></div>`; // Remove chat box
        }

        // Send Message
        function sendMessage() {
            const messageInput = document.getElementById('chat-message');
            const messageText = messageInput.value;
            
            if (messageText.trim() !== '') {
                const messagesDiv = document.getElementById('messages');
                const newMessage = document.createElement('div');
                newMessage.className = 'chat-message';
                newMessage.innerText = messageText;
                messagesDiv.appendChild(newMessage);
                
                // Clear the input field
                messageInput.value = '';
            }
        }

        // Scroll Effects
        document.addEventListener('DOMContentLoaded', () => {
            const items = document.querySelectorAll('.grid-item');

            const handleScroll = () => {
                const windowHeight = window.innerHeight;

                items.forEach(item => {
                    const rect = item.getBoundingClientRect();
                    // Check if the item is in the viewport
                    if (rect.top < windowHeight && rect.bottom > 0) {
                        item.classList.add('visible');
                    } else {
                        item.classList.remove('visible');
                    }
                });
            };

            // Initialize visible elements on page load
            handleScroll();

            // Attach the scroll event
            document.addEventListener('scroll', handleScroll);
        });
        function submitFeedback() {
        const title = document.getElementById('feedback-title').value;
        const description = document.getElementById('feedback-description').value;
        const messageDiv = document.getElementById('feedback-message');

        if (!title || !description) {
            messageDiv.textContent = 'Please complete all required fields.';
            messageDiv.style.color = 'red';
            return;
        }

        // Increment brownie points
        let currentPoints = parseInt(localStorage.getItem('browniePoints') || '0', 10);
        currentPoints += 10;
        localStorage.setItem('browniePoints', currentPoints);

        // Clear form
        document.getElementById('feedback-form').reset();

        // Show success message
        messageDiv.textContent = 'Thank you for your feedback! You earned 10 brownie points.';
        messageDiv.style.color = 'green';
    }

    // Function to load brownie points
    function loadBrowniePoints() {
        return parseInt(localStorage.getItem('browniePoints') || '0', 10);
    }
    </script>
</body>
</html>
